VarUti.coh <- 
function(XY){
X1=XY[1];  X2=XY[2]; X3=XY[3]; X4=XY[4];
Y1=XY[5];  Y2=XY[6]; Y3=XY[7]; Y4=XY[8];

n1 <- X1+X2+X3+X4; n0 <- Y1+Y2+Y3+Y4; n <- n1+n0
p1 <- X1/n; p2 <- X2/n; p3 <- X3/n; p4 <- X4/n;
q1 <- Y1/n; q2 <- Y2/n; q3 <- Y3/n; q4 <- Y4/n;
res <- ((-1 + p2 + p4 + q2 + q4)*((p1 + q1)^3*q2*(p3 + q3)^3*(p4 + q4)*(-((p2*(-1 + p2 + p4 + q2 + q4)*(p2 + p4 + q2 + q4))/(p2 + q2)^2) +
     (1 - p2 - p4 - q2 - q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)) -
     (p2 + p4 + q2 + q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)))*
    (-(p1*(p2^3*(-2*p4*q3 + 2*p3*q4) - q2^2*(-1 + 2*p4 + 2*q2 + 2*q4)*(p3*p4 + q3*(2*p4 + q4)) + p2^2*(q3*(-2*p4^2 + q4 - 2*q2*q4 - 2*p4*(-1 + 4*q2 + q4)) +
          p3*(2*q4*(2*q2 + q4) + p4*(1 - 2*q2 + 2*q4))) + p2*(q3*(p4^2*(1 - 6*q2) - (-1 + 2*q2)*q4*(2*q2 + q4) + 2*p4*(2*q2 - 5*q2^2 + q4 - 4*q2*q4)) +
          p3*(p4^2*(1 - 2*q2) + 2*p4*(q2 - 2*q2^2 + q4) + q4*(2*q2^2 + q4 + 2*q2*q4))))) -
     q1*(-(q2^2*(-1 + 2*p4 + 2*q2 + 2*q4)*(p4*q3 - p3*q4)) + 2*p2^3*(q3*q4 + p3*(p4 + 2*q4)) +
       p2^2*(q3*(2*q4*(2*q2 + q4) + p4*(1 - 2*q2 + 2*q4)) + p3*(2*p4^2 + q4*(-1 + 10*q2 + 4*q4) + p4*(4*q2 + 6*q4))) +
       p2*(q3*(p4^2*(1 - 2*q2) + 2*p4*(q2 - 2*q2^2 + q4) + q4*(2*q2^2 + q4 + 2*q2*q4)) + p3*(p4^2*(1 + 2*q2) + 2*p4*(q2^2 + q4 + 4*q2*q4) +
           q4*(-2*q2 + 8*q2^2 + q4 + 6*q2*q4))))) - p2*(p1 + q1)^3*(p3 + q3)^3*(p4 + q4)*((q2*(-1 + p2 + p4 + q2 + q4)*(p2 + p4 + q2 + q4))/(p2 + q2)^2 +
     (1 - p2 - p4 - q2 - q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)) -
     (p2 + p4 + q2 + q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)))*(2*p2^3*(-(p1*p4*q3) + q1*q3*q4 + p3*(p4*q1 + p1*q4 + 2*q1*q4)) -
     2*p2*q2*(-(q1*(-(q3*(p4^2 + 2*p4*q2 - q4*(-1 + q2 + q4))) + p3*(p4^2 + q4*(-2 + 4*q2 + 3*q4) + p4*(-1 + q2 + 4*q4)))) +
       p1*(p3*(p4^2 + 2*p4*q2 - q4*(-1 + q2 + q4)) + q3*(3*p4^2 + q4*(2*q2 + q4) + p4*(-1 + 5*q2 + 4*q4)))) +
     p2^2*(-(q3*(q1*(2*p4*(q2 - q4) + (1 - 4*q2 - 2*q4)*q4) + p1*(2*p4^2 + 2*q2*q4 + p4*(-1 + 8*q2 + 2*q4)))) +
       p3*(2*p4^2*q1 + q4*(p1*(-1 + 4*q2 + 2*q4) + 2*q1*(-1 + 5*q2 + 2*q4)) + p4*(2*p1*(-q2 + q4) + q1*(-1 + 4*q2 + 6*q4)))) -
     q2*(q1*(p3*(p4^2 + q4*(2*q2 - 2*q2^2 + q4 - 2*q2*q4) + p4*(q2 + 2*q4 - 2*q2*q4)) + q3*(p4^2*(1 + 2*q2) + q4*(q2 + q4) + 2*p4*(q2^2 + q4 + q2*q4))) +
       p1*(p3*(p4^2*(1 + 2*q2) + q4*(q2 + q4) + 2*p4*(q2^2 + q4 + q2*q4)) + q3*(p4^2*(1 + 4*q2) + q4*(2*q2^2 + q4 + 2*q2*q4) +
           p4*(-q2 + 4*q2^2 + 2*q4 + 6*q2*q4))))) + p3*(p1 + q1)^3*(p2 + q2)*q3*(p4 + q4)*(p2 + p4 + q2 + q4)^2*
    (p1*(p2^2*(-2*p4*q3^2 + 2*p3^2*q4 + p3*(p4 - 2*p4*q3 + q4 + 2*q3*q4)) + q2*(-(p3^2*p4*(-1 + 2*p4 + 2*q2 + 2*q4)) - q3^2*(2*p4 + q4)*(-1 + 2*p4 + 2*q2 + 2*q4) +
         p3*(p4^2*(1 - 6*q3) + p4*(-1 + q2 + 3*q3 - 6*q2*q3 + 2*q4 - 8*q3*q4) + q4*(-1 + q2 + q3 - 2*q2*q3 + q4 - 2*q3*q4))) +
       p2*(q3^2*(p4 - 2*p4^2 - 6*p4*q2 - 2*p4*q4 - 2*q2*q4) + p3^2*(-2*p4*(q2 - q4) + q4*(-1 + 2*q2 + 2*q4)) +
         p3*(p4^2*(1 - 2*q3) + p4*(-1 + 2*q2 + q3 - 8*q2*q3 + 2*q4) + q4*(-1 + 2*q2 - q3 + q4 + 2*q3*q4)))) +
     q1*(p2^2*(2*q3^2*q4 + 2*p3^2*(p4 + 2*q4) + p3*(p4 + 2*p4*q3 + q4 + 6*q3*q4)) + q2*(-(p4*q3^2*(-1 + 2*p4 + 2*q2 + 2*q4)) + p3^2*q4*(-1 + 2*p4 + 2*q2 + 2*q4) +
         p3*(p4^2*(1 - 2*q3) + p4*(-1 + q2 + q3 - 2*q2*q3 + 2*q4) + q4*(-1 + q2 - q3 + 2*q2*q3 + q4 + 2*q3*q4))) +
       p2*(q3^2*(-2*p4*(q2 - q4) + q4*(-1 + 2*q2 + 2*q4)) + p3^2*(2*p4^2 + 2*q4*(-1 + 3*q2 + 2*q4) + p4*(-1 + 2*q2 + 6*q4)) +
         p3*(p4^2*(1 + 2*q3) + q4*(-1 + 2*q2 - 3*q3 + 8*q2*q3 + q4 + 6*q3*q4) + p4*(-1 + 2*q2 - q3 + 2*q4 + 8*q3*q4))))) +
   p3*(p1 + q1)^3*(p2 + q2)*q3*(p4 + q4)*(p2 + p4 + q2 + q4)^2*(p2^2*(-2*p3^2*(p4*q1 + (p1 + 2*q1)*q4) + 2*p3*q3*(p1*(p4 - q4) - q1*(p4 + 3*q4)) +
       q3*(p1*(p4 + 2*p4*q3 + q4) + q1*(p4 + q4 - 2*q3*q4))) +
     q2*(q1*(p4^2*q3*(1 + 2*p3 + 2*q3) + q4*(p3^2*(1 - 2*q2 - 2*q4) + p3*q3*(1 - 2*q2 - 2*q4) + q3*(-1 + q2 + q4)) +
         p4*(-2*p3^2*q4 + q3^2*(-1 + 2*q2 + 2*q4) + q3*(-1 - p3 + q2 + 2*p3*q2 + 2*q4))) +
       p1*(p3^2*p4*(-1 + 2*p4 + 2*q2 + 2*q4) + p3*q3*(3*p4 + q4)*(-1 + 2*p4 + 2*q2 + 2*q4) + q3*(p4^2*(1 + 4*q3) + q4*(-1 + q2 - q3 + 2*q2*q3 + q4 + 2*q3*q4) +
           p4*(-1 + q2 - 2*q3 + 4*q2*q3 + 2*q4 + 6*q3*q4)))) +
     p2*(p3*q3*(q1*(p4 - 2*p4^2 - 8*p4*q4 + (3 - 8*q2 - 6*q4)*q4) + p1*(2*p4^2 + p4*(-1 + 8*q2) + q4 - 2*q4^2)) -
       p3^2*(2*p4^2*q1 + q4*(p1*(-1 + 2*q2 + 2*q4) + 2*q1*(-1 + 3*q2 + 2*q4)) + p4*(2*p1*(-q2 + q4) + q1*(-1 + 2*q2 + 6*q4))) +
       q3*(q1*(p4^2 + q4*(-1 - 2*q2*(-1 + q3) + q3 + q4 - 2*q3*q4) + p4*(-1 + 2*q2*(1 + q3) + 2*q4 - 2*q3*q4)) +
         p1*(p4^2*(1 + 2*q3) + q4*(-1 + 2*q2*(1 + q3) + q4) + p4*(q2*(2 + 6*q3) + (1 + q3)*(-1 + 2*q4)))))) +
   p1*q1*(p2 + q2)*(p3 + q3)^3*(p4 + q4)*(p2 + p4 + q2 + q4)^2*(p2^2*(p3*(p4*q1*(1 + 2*p1 + 2*q1) + (2*p1^2 + q1 + 6*p1*q1 + 4*q1^2)*q4) +
       q3*(-2*p1^2*p4 + 2*p1*q1*(-p4 + q4) + q1*(p4 + q4 + 2*q1*q4))) + q2*(-(p1^2*(-1 + 2*p4 + 2*q2 + 2*q4)*(p3*p4 + q3*(2*p4 + q4))) -
       p1*q1*(-1 + 2*p4 + 2*q2 + 2*q4)*(p3*(p4 - q4) + q3*(3*p4 + q4)) +
       q1*(q3*(p4^2*(1 - 2*q1) + q4*(-1 + q2 + q4) + p4*(-1 + q1 + q2 - 2*q1*q2 + 2*q4 - 2*q1*q4)) +
         p3*(p4^2 + p4*(-1 + q2 + 2*(1 + q1)*q4) + q4*(-1 + q2 + q4 + q1*(-1 + 2*q2 + 2*q4))))) +
     p2*(q3*(p1^2*(p4 - 2*p4^2 - 6*p4*q2 - 2*p4*q4 - 2*q2*q4) + p1*q1*(p4 - 2*p4^2 - 8*p4*q2 + q4*(-1 + 2*q4)) +
         q1*(p4^2 + p4*(-1 - 2*(-1 + q1)*q2 + 2*(1 + q1)*q4) + q4*(-1 + 2*q2 + q4 + q1*(-1 + 2*q2 + 2*q4)))) +
       p3*(p4^2*q1*(1 + 2*p1 + 2*q1) + p4*(2*p1^2*(-q2 + q4) + q1^2*(-1 + 2*q2 + 6*q4) + q1*(-1 - p1 + 2*q2 + 2*q4 + 8*p1*q4)) +
         q4*(p1^2*(-1 + 2*q2 + 2*q4) + p1*q1*(-3 + 8*q2 + 6*q4) + q1*(-1 + 2*q2 + q4 + q1*(-2 + 6*q2 + 4*q4)))))) -
   (p1 + q1)^3*(p2 + q2)*(p3 + q3)^3*q4*((p4*(-1 + p2 + p4 + q2 + q4)*(p2 + p4 + q2 + q4))/(p4 + q4)^2 +
     (1 - p2 - p4 - q2 - q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)) -
     (p2 + p4 + q2 + q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)))*
    (p1*(p2^2*(-(p4*q3*(1 + 2*p4 + 2*q4)) + p3*(-p4 + 2*p4*q4 + 2*q4^2)) - p2*(p3*(p4^2*(1 + 2*q2 - 2*q4) + (1 - 2*q2 - 2*q4)*q4^2 + 2*p4*(q2 + q4 - 2*q4^2)) +
         2*q3*(p4^3 + q2*q4^2 + p4^2*(3*q2 + 2*q4) + p4*(q2 + 4*q2*q4 + q4^2))) - q2*(p3*p4*(2*p4^2 + q2 + 2*q2*q4 + 2*q4^2 + 2*p4*(q2 + 2*q4)) +
         q3*(4*p4^3 + q4^2*(-1 + 2*q2 + 2*q4) + p4^2*(-1 + 4*q2 + 10*q4) + p4*(q2 - 2*q4 + 6*q2*q4 + 8*q4^2)))) +
     q1*(p2^2*(q3*(-p4 + 2*p4*q4 + 2*q4^2) + p3*(-p4 + 2*p4^2 + 6*p4*q4 + 4*q4^2)) + q2*(-(p4*q3*(2*p4^2 + q2 + 2*q2*q4 + 2*q4^2 + 2*p4*(q2 + 2*q4))) +
         p3*(p4^2*(-1 + 2*q4) + p4*(-1 + 2*q4)*(q2 + 2*q4) + q4^2*(-1 + 2*q2 + 2*q4))) +
       p2*(-(q3*(p4^2*(1 + 2*q2 - 2*q4) + (1 - 2*q2 - 2*q4)*q4^2 + 2*p4*(q2 + q4 - 2*q4^2))) + 2*p3*(p4^3 + q4^2*(-1 + 3*q2 + 2*q4) + p4^2*(-1 + q2 + 4*q4) +
           p4*(q2*(-1 + 4*q4) + q4*(-2 + 5*q4)))))) - p4*(p1 + q1)^3*(p2 + q2)*(p3 + q3)^3*(-((q4*(-1 + p2 + p4 + q2 + q4)*(p2 + p4 + q2 + q4))/(p4 + q4)^2) +
     (1 - p2 - p4 - q2 - q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)) -
     (p2 + p4 + q2 + q4)*(p1/(p1 + q1) - p2/(p2 + q2) - p3/(p3 + q3) + p4/(p4 + q4)))*
    (p2^2*(q3*(q1*q4*(1 + 2*p4 + 2*q4) + p1*(-2*p4^2 + q4 - 2*p4*q4)) + p3*(2*p4^2*q1 + 2*p4*(p1 + 3*q1)*q4 + q4*(p1 + q1 + 2*p1*q4 + 4*q1*q4))) +
     q2*(q1*(-2*p4^3*q3 + p4^2*(q3 - 2*q2*q3 + 2*p3*q4 - 4*q3*q4) + 2*p4*q4*(-(q3*(-1 + q2 + q4)) + p3*(q2 + 2*q4)) +
         q4*(q3*(q2 + q4) + p3*(q2 + 2*q2*q4 + 2*q4^2))) + p1*(p3*(-2*p4^3 + p4^2*(1 - 2*q2 - 4*q4) - 2*p4*q4*(-1 + q2 + q4) + q4*(q2 + q4)) -
         q3*(4*p4^3 + 2*p4*q4*(-2 + 3*q2 + 4*q4) + 2*p4^2*(-1 + 2*q2 + 5*q4) + q4*(2*(-1 + q4)*q4 + q2*(-1 + 2*q4))))) +
     p2*(q3*(p1*(-2*p4^3 + p4^2*(1 - 6*q2 - 4*q4) - 2*p4*q4*(-1 + 4*q2 + q4) + q4*(2*q2 + q4 - 2*q2*q4)) +
         2*q1*(2*p4*q4^2 + p4^2*(-q2 + q4) + q4*(q2 + q2*q4 + q4^2))) + p3*(2*p4^3*q1 + 2*p4*q4*(2*p1*q4 + q1*(-1 + 4*q2 + 5*q4)) +
         p4^2*(2*p1*(-q2 + q4) + q1*(-1 + 2*q2 + 8*q4)) + q4*(2*p1*(q2 + q2*q4 + q4^2) + q1*(q4*(-1 + 4*q4) + q2*(2 + 6*q4)))))) +
   p1*q1*(p2 + q2)*(p3 + q3)^3*(p4 + q4)*(p2 + p4 + q2 + q4)^2*(p1^2*(-1 + 2*p2 + 2*p4 + 2*q2 + 2*q4)*(p3*p4*q2 + p2*p4*q3 + 2*p4*q2*q3 - p2*p3*q4 + q2*q3*q4) -
     q1^2*(-1 + 2*p2 + 2*p4 + 2*q2 + 2*q4)*(-(p4*q2*q3) + p3*q2*q4 + p2*(q3*q4 + p3*(p4 + 2*q4))) +
     p1*(p2^2*(p3*(p4 - 2*p4*q1 + q4 - 6*q1*q4) + q3*(p4 + 2*p4*q1 + q4 - 2*q1*q4)) +
       p2*(p3*(p4^2*(1 - 2*q1) + q4*(-1 + 2*q2 + q1*(3 - 8*q2 - 6*q4) + q4) + p4*(-1 + q1 + 2*q2 + 2*q4 - 8*q1*q4)) +
         q3*(p4^2*(1 + 2*q1) + p4*(-1 - q1 + 2*q2 + 8*q1*q2 + 2*q4) + q4*(-1 + q1 + 2*q2 + q4 - 2*q1*q4))) +
       q2*(p3*(p4^2*(1 + 2*q1) + p4*(-1 - q1 + q2 + 2*q1*q2 + 2*q4) + q4*(-1 + q1 + q2 - 2*q1*q2 + q4 - 2*q1*q4)) +
         q3*(p4^2*(1 + 6*q1) + q4*(-1 + q2 + q4 + q1*(-1 + 2*q2 + 2*q4)) + p4*(-1 + q2 + 2*q4 + q1*(-3 + 6*q2 + 8*q4))))))))/
 (n*(p1 + q1)^4*(p2 + q2)^2*(p3 + q3)^4*(p4 + q4)^2)
return(res)
}